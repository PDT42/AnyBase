{% macro plugin_macro(column_info) %}
<script>
    column_info = JSON.parse('{{ column_info.as_dict()|tojson }}');

    // Putting this into a function is important
    // The variable names used, will otherwise
    // be globally declared and not be usable
    // within the same html again. If we want to
    // use the same plugin twice in one layout
    // tho - that must be possible.

    function appendListItems(items, assetList, employedColumns) {

        for (let index in items) {

            let assetData = items[index]

            let assetCard = document.createElement('a');
            assetCard.setAttribute('id', '{{column_info.column_id}}-asset-' + assetData['asset_id'])
            assetCard.setAttribute('class', 'list-group-item card');
            assetCard.setAttribute('href', '#'); // TODO: Insert correct link
            assetCard.setAttribute('style', 'margin-bottom: 15px');
            assetList.appendChild(assetCard);

            let assetCardBody = document.createElement('div');
            assetCardBody.setAttribute('class', 'card-body');
            assetCard.appendChild(assetCardBody);

            let cardTitle = document.createElement('h5');
            cardTitle.setAttribute('class', 'card-title');
            cardTitle.innerText = assetData['data'][employedColumns[0]];
            assetCardBody.appendChild(cardTitle);
        }
    }

    function initListAssets() {
        const root = document.getElementById('column-' + column_info['column_id']);

        let assetList = document.createElement('div');
        assetList.setAttribute('class', 'list-group');
        root.appendChild(assetList);

        let employedColumns = column_info['employed_columns'];

        appendListItems(items, employedColumns)

        itemsPubSub.subscribe('items-data', function (items) {
            appendListItems(items, assetList, employedColumns)
        })
    }

    initListAssets();
</script>
{% endmacro %}